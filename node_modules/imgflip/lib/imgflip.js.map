{"version":3,"file":"imgflip.js","sources":["../src/index.js"],"sourcesContent":["import stream from 'stream'\nimport fs from 'fs'\nimport { promisify } from 'util'\nimport got from 'got'\n\nconst pipeline = promisify(stream.pipeline)\n\nclass Imgflip {\n  constructor ({ username, password }) {\n    this.username = username\n    this.password = password\n  }\n\n  // https://api.imgflip.com\n  async request(path, options) {\n    const response = await got(path, { prefixUrl: `https://api.imgflip.com`, ...options }).json()\n\n    if (response.success === true) {\n      return response.data\n    }\n\n    throw new Error(response.error_message)\n  }\n\n  async memes() {\n    return (await this.request(`get_memes`)).memes\n  }\n\n  async meme(id, captions, options = {}) {\n    const { url } = await this.request(`caption_image`, {\n      method: `POST`,\n      json: {\n        template_id: id,\n        username: this.username,\n        password: this.password,\n        boxes: captions.map(caption => ({ text: caption }))\n      }\n    })\n\n    if (options.path == null) {\n      return url\n    }\n\n    await pipeline(\n      got.stream(url),\n      fs.createWriteStream(path)\n    )\n  }\n}\n\nexport default Imgflip\n"],"names":["const","pipeline","promisify","stream","Imgflip","constructor","password","username","request","path","options","got","prefixUrl","json","response","success","data","Error","error_message","memes","meme","id","captions","method","template_id","boxes","map","caption","text","url","fs","createWriteStream"],"mappings":";;;;;;;AAKAA,IAAMC,QAAQ,GAAGC,cAAS,CAACC,MAAM,CAACF,QAAR,CAA1B;;AAEA,IAAMG,OAAN,GACEC,gBAAW,IAAA,EAA0B;8BAAZC;;;OAClBC,QAAL,GAAgBA,QAAhB;OACKD,QAAL,GAAgBA,QAAhB;EAHU;;;kBAONE,4BAAQC,IAPF,EAOQC,OAPR;MAOiB;2BACJC,GAAG,CAACF,IAAD,EAAO,mBAAEG,SAAS,EAAG,0BAAd;MAA2CF,QAAlD,CAAH,CAAgEG,IAAhE,EADI,iBACrBC,QADqB;UAGvBA,QAAQ,CAACC,OAAT,KAAqB,IAAzB,EAA+B;eACtBD,QAAQ,CAACE,IAAhB;;;YAGI,IAAIC,KAAJ,CAAUH,QAAQ,CAACI,aAAnB,CAAN;;GAdU;;;;;kBAiBNC;MAAQ;gBACE,IADF;;2BACE,MAAKX,OAAL,CAAc,WAAd,CADF;aACL,cAAkCW,KAAzC;;GAlBU;;;;;kBAqBNC,sBAAKC,EArBC,EAqBGC,QArBH,EAqBaZ,OArBb;qCAqBoB,GAAG;;MAAI;iBACf,IADe;;2BACf,OAAKF,OAAL,CAAc,eAAd,EAA8B;MAClDe,MAAM,EAAG,MADyC;MAElDV,IAAI,EAAE;QACJW,WAAW,EAAEH,EADT;QAEJd,QAAQ,EAAE,OAAKA,QAFX;QAGJD,QAAQ,EAAE,OAAKA,QAHX;QAIJmB,KAAK,EAAEH,QAAQ,CAACI,GAAT,WAAaC,mBAAY;UAAEC,IAAI,EAAED;SAAb,IAApB;;KANW,CADe,oBAAA;;;aAWjCjB,OAAO,CAACD,IAAR,IAAgB,IAXiB,GAY5BoB,GAZ4B,mBAe/B5B,QAAQ,CACZU,GAAG,CAACR,MAAJ,CAAW0B,GAAX,CADY,EAEZC,EAAE,CAACC,iBAAH,CAAqBtB,IAArB,CAFY,CAfuB;;GArB3B;;;;;;;"}